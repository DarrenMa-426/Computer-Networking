# 标准客户-服务器应用
+ HTTP和万维网
+ 文件传输和电子邮件应用
+ TELNET 和 SSH 协议（远程登录）
+ DNS

## 万维网
+ 万维网（WWW/Web）是分布式的（distributed）和链接的（linked）
  + 分布式：分布式允许 Web 增长。世界上每个 Web 服务器都可以增加一个新的网页到这个宝库中并向所有因特网用户宣告，而这不会使一些服务器超载。
  + 链接：链接使得一个网页与另一个存储在世界某个地方的主机上的网页相互引用。
+ 如今 WWW 是一个分布式客户-服务器服务。使得浏览器的用户可以访问一个正在服务器上运行的服务。然而服务是分布在很多称为站点（site）的地点上。每一个站点有一个或多个文档，它们称为网页。但是，每个网页（web page）可以包含一些到其他网页的链接，那些被链接的网页可以在同一个站点也可以在其他站点。
+ 网络客户（浏览器）通常包含三部分：控制程序、客户协议和解释程序。
  + 控制程序接收来自键盘和鼠标的输入并使用客户端程序来访问文档；
  + 客户协议可以是HTTP 或 FTP；
  + 在文档被访问后，控制程序使用解释程序来在屏幕上显示文档；（HTML、Java 或 Javascript）
+ 网络资源定位符（URL）包含了四个标识符：协议、主机、端口、路径。
+ 网上文档
  + 静态文档（Static Document）：静态文档是在服务器中创建和存储的固定内容的文档。文件的内容在创建时决定，而不是使用时决定。（Hypertext Markup Language, HTML、Extensible Markup Language, XML、Extensible Style Language, XSL）;
  + 动态文档（Dynamic Document）：当浏览器请求文档时动态文档就被网页服务器创建。由于对每个请求都要创建一个全新的文档，因此动态文档的内容随着请求的不同而不同。（CGI、JSP、ASP）
  + 活动文档（Active Document）：对很多应用来说，我们需要在客户站点运行一个程序或脚本，这些称为活动文档。（Javascript）

## 超文本传输协议（HTTP）
+ HTTP 是一种用来定义客户服务器程序如何编写和如何从万维网获取网页的协议。一个 HTTP 客户发送一个请求；HTTP 服务器返回响应。服务器使用80端口号；客户使用一个临时端口号。HTTP 使用 TCP 服务。
+ 非持续连接
  + 客户开启一个 TCP 连接并发送请求；
  + 服务器发送响应并关闭连接；
  + 客户读取数据直到它遇到了文件结束标记，然后关闭连接；
+ 非持续策略给服务器带来了高额开销，因为每次连接被开启时服务器都需要 N+1 个不同的缓冲区。
+ HTTP1.1 版默认指定了持续连接。在持续连接中服务器在发送一个相应后，为响应更多的请求而将连接置为打开状态。服务器可以在客户的请求下或者在超时情况下将连接关闭。发送方通常在每次响应中发送数据长度。
+ 请求报文
  + 请求的第一行被称为请求行，这一行有三部分由空格隔开并且被两个字符（回车和换行）终止。这些字段称为方法、URL 和版本。
+ 请求方法
  + GET：向服务器请求文档；
  + HEAD：请求关于文档的信息，而不是文档本身；
  + PUT：从客户端向服务器发送文档；
  + POST：从客户端向服务器发送一些信息；
  + TRACE：回送输入的请求；
  + DELETE：删除网页；
  + CONNECT：预留；
  + OPTIONS：询问有关可用的选项；
+ 请求头部
  + User-agent：表示客户端程序；
  + Accept：给出客户端能够接受的媒体格式；
  + Accept-charset：给出客户端可以处理的字符集；
  + Accept-encoding：给出客户端可以处理的编码方案；
  + Accept-language：给出客户端可以接受的语言；
  + Authorization：给出客户端有哪些许可；
  + Host：给出主机及客户端的端口号；
  + Date：给出当前日期；
  + Upgrade：确定首选的通信协议；
  + Cookie：返回 cookie 给服务器
  + If-Modified-Since：如果文档在指定的日期之后被更新，则发送文档；
+ 响应报文
  + 响应报文包含状态行、头部行并且有时包含主体。
  + 状态码字段
    + 100~199：代表一个报告；
    + 200~299：表示这是一个成功的请求；
    + 300~399：表示把客户端重定向到另一个 URL；
    + 400~499：表示在客户端发生错误；
    + 500~599：表示在服务端发生错误；
+ 响应头部行
  + Date：给出当前日期；
  + Upgrade：确定首选的通信协议；
  + Server：给出服务器信息；
  + Set-Cookie：服务器要求客户存储 cookie；
  + Content-Encoding：指定编码方案；
  + Content-Language：指定语言；
  + Content-Length：给出文档长度；
  + Content-Type：指定媒体类型；
  + Location：指明新建或移动后文档的位置；
  + Accept-Ranges：服务器将会接收的被请求的字节范围；
  + Last-modified：给出上次改变的日期和时间；

## Cookie
+ 创建和存储 Cookie
  + 当服务器从客户端接收到请求后，它将客户端的信息存储在文件或字符串中。这些信息可能包括客户端的域名、cookie 内容（服务器收集到的关于客户端的信息，如主机名、注册号等）、时间戳，以及与实现相关的其他信息；
  + 服务器在响应中包含了它发送给客户端的 cookie；
  + 当客户端接收到响应后，浏览器在 cookie 目录中存储 cookie，并根据服务器域名进行分类；
+ 使用 cookie
  + 当客户向服务器发送请求时，浏览器在 cookie 目录中查询是否有从那个服务器发送过来的 cookie，如果有，则在请求中包含这个 cookie。

## 万维网高速缓存：代理服务器
HTTP 支持代理服务器（proxy server）。代理服务器是一台计算机，能够保存最近请求的响应的副本。HTTP 客户端向代理服务器发送请求。代理服务器检查本地高速缓存。如果高速缓存中不存在响应报文，代理服务器就向响应的服务器发送请求。返回的响应会发送到代理服务器中，并且进行存储，以用于其他客户端将来的请求。（如七牛 cdn 加速）

## HTTP 安全
HTTP 本质上并不提供安全。然而，HTTP 可以在安全套接层（SSL）上运行。在这种情况下，HTTP 称为 HTTPS。HTTPS 提供保密性、客户和服务器鉴别，以及数据完整性。

## FTP
+ 文件传输协议（File Transfer Protocol, FTP）是 TCP/IP 提供的标准机制，用于将文件从一个主机复制到另一个主机。
+ FTP 基本模型中。客户有三个组件：用户接口、客户控制进程、数据传输进程。服务器有两个组件：服务器控制进程和服务器数据传输进程。控制连接是在控制进程之间进行的，而数据连接是在数据传输进程之间进行的。
+ 在整个交互的 FTP 会话期间，控制连接始终处理连接状态。数据连接则在每次传输文件时开启然后关闭。FTP 使用两种熟知接口，端口 21 用于控制连接，端口 20 用于数据连接。
+ 控制连接
  + 对于控制通信，FTP 使用与 TELNET 相同的方法。它与 TELNET 一样使用 NVT ASCII 字符集。通信是通过命令和响应来完成的。
  + 常见的 FTP 命令
    | 命 令 | 参 数        | 说 明                                           |
    | ----- | :----------: | ----------------------------------------------: |
    | ABOR  |              | 放弃之前的命令                                  |
    | CDUP  |              | 改变到上级父目录                                |
    | CWD   | 目录名       | 改变到另一个目录                                |
    | DELE  | 文件名       | 删除文件                                        |
    | LIST  | 目录名       | 列出子目录或文件                                |
    | MKD   | 目录名       | 创建新目录                                      |
    | PASS  | 用户密码     | 密码                                            |
    | PASV  |              | 服务器选择一个端口                              |
    | PORT  | 端口标识符   | 客户选择一个端口                                |
    | PWD   |              | 显示当前目录名                                  |
    | QUIT  |              | 退出登录                                        |
    | RETR  | 文件名       | 获取文件；文件从服务器发送到客户                |
    | RMD   | 目录名       | 删除目录                                        |
    | RNFR  | 文件名       | 表示一个将被重命名的文件                        |
    | RNTO  | 文件名（新） | 重命名文件                                      |
    | STOR  | 文件名       | 存储文件；文件从客户发送到服务器                |
    | STRU  | F、R 或 P    | 定义数据组织（F：文件， R：记录，或者 P：页面） |
    | TYPE  | A、E、I      | 定义文件类型（A：ASCII，E：EBCDID，I：图像      |
    | USER  | 用户 ID      | 用户信息                                        |
    | MODE  | S、B、C      | 定义传输方式（S：流，B：块，C：压缩）           |
  + 常见的响应编码
    + 125：数据连接打开；
    + 150：文件状态良好；
    + 200：命令成功；
    + 220：服务就绪；
    + 221：服务关闭；
    + 225：数据连接打开；
    + 226：关闭数据连接；
    + 230：用户登录成功；
    + 250：请求文件动作成功；
    + 331：用户名成功；需要密码；
    + 425：无法打开数据连接；
    + 450：文件动作未被采取；文件不可用；
    + 452：动作被放弃；磁盘空间不足；
    + 500：语法错；无法识别的命令；
    + 501：参数或变量语法错；
    + 530：用户未登录；
+ 数据连接
  + 数据连接的步骤
    + 客户使用临时端口发起一个被动打开。这必须由客户完成，因为正是客户发出命令要求传输文件的；
    + 客户使用 PORT 命令发送这个端口号到服务器；
    + 服务器接收到端口号，使用熟知端口 20 发出主动打开并且接收临时端口号；
  + 数据连接的目的和实现与控制连接是不同的。在通过数据连接发送文件之前，我们必须通过控制连接定义传输文件的类型、数据结构以及传输方式。
+ FTP 安全：尽管 FTP 要求密码，但是密码还是用明文（未加密）发送，这意味着它可能被截获并被使用者攻击。数据传输连接也用明文传输数据，这是不安全的。为了安全起见，可以将安全套接层加入到 FTP 应用层和 TCP 层之间。这种情况下，FTP 称为 SSL-FTP。

## 电子邮件
+ 一个子邮件系统需要两个 UA（User Agent），一对 MTA（Mail Transfer Agent）（客户与服务器）以及一对 MAA（Mail Access Agent）（客户与服务器）
+ 传输一个邮件共有三个阶段：连接建立、邮件传输和连接终止。
  + 连接建立：在客户创建了到端口 25 的 TCP 连接后，SMTP（Simple Mail Transfer Protocol） 服务器开始连接阶段。
  + 邮件传输：在 SMTP 客户和服务器的连接建立后，单个报文可以在一个发信人和多个收信人之间交换。
  + 连接终止：在报文成功传送后，客户终止连接。
+ 报文访问代理：邮件传递的第一阶段和第二阶段使用 SMTP。但是，因为 SMTP 是一个推（push）协议，第三阶段不使用 SMTP。第三阶段可以使用 POP、IMAP、HTTP 协议。